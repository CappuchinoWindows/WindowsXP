<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Damas - Windows XP</title>

<style>
/* ===== RESET ===== */
* {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
}

/* ===== ESCRITORIO XP ===== */
body {
    width: 100vw;
    height: 100vh;
    background: #3a6ea5;
    font-family: Tahoma, Arial, sans-serif;
}

/* ===== VENTANA XP COMPLETA ===== */
.xp-window {
    width: 100%;
    height: 100%;
    background: #ece9d8;
    display: flex;
    flex-direction: column;
}

/* ===== BARRA DE TITULO ===== */
.xp-titlebar {
    height: 30px;
    background: linear-gradient(#0a5bd3, #084fc1);
    color: white;
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0 8px;
    font-size: 13px;
    font-weight: bold;
}

/* ===== BOTONES ===== */
.xp-buttons span {
    display: inline-block;
    width: 20px;
    height: 20px;
    background: #cdd9f2;
    color: black;
    text-align: center;
    line-height: 18px;
    margin-left: 4px;
    border: 1px solid #555;
}

/* ===== MENU ===== */
.xp-menu {
    height: 26px;
    background: #ece9d8;
    border-bottom: 1px solid #aaa;
    padding: 4px 8px;
    font-size: 13px;
}

/* ===== CONTENIDO ===== */
.xp-content {
    flex: 1;
    background: #ece9d8;
    padding: 10px;
    display: flex;
    flex-direction: column;
    align-items: center;
}

/* ===== TURNO ===== */
#turno {
    width: 200px;
    background: white;
    border: 2px inset #aaa;
    padding: 4px;
    margin-bottom: 8px;
    text-align: center;
    font-size: 14px;
}

/* ===== TABLERO ===== */
.tablero {
    display: grid;
    grid-template-columns: repeat(8, 60px);
    border: 3px inset #999;
    background: #999;
}

/* ===== CASILLAS ===== */
.casilla {
    width: 60px;
    height: 60px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.blanca { background: #f0d9b5; }
.negra { background: #b58863; }

/* ===== PIEZAS ===== */
.pieza {
    width: 44px;
    height: 44px;
    border-radius: 50%;
    cursor: pointer;
    border: 2px solid #222;
}

.roja {
    background: radial-gradient(#ff8080, #b00000);
}

.negra-pieza {
    background: radial-gradient(#777, #000);
}

/* ===== DAMA ===== */
.dama {
    box-shadow: inset 0 0 0 4px gold;
}

/* ===== SELECCION ===== */
.seleccionada {
    outline: 3px dashed yellow;
}
</style>
</head>

<body>

<div class="xp-window">

    <div class="xp-titlebar">
        <span>Damas - Internet Explorer</span>
        <div class="xp-buttons">
            <span>—</span><span>□</span><span>✕</span>
        </div>
    </div>

    <div class="xp-menu">
        Archivo | Edición | Ver | Favoritos | Herramientas | Ayuda
    </div>

    <div class="xp-content">
        <div id="turno">Turno: Rojas</div>
        <div class="tablero" id="tablero"></div>
    </div>

</div>

<script>
/* ===== TU LÓGICA ORIGINAL ===== */
const tablero = document.getElementById("tablero");
const turnoTexto = document.getElementById("turno");

let turno = "roja";
let seleccionada = null;
let debeSeguirComiendo = false;

function crearTablero() {
    tablero.innerHTML = "";
    for (let f = 0; f < 8; f++) {
        for (let c = 0; c < 8; c++) {
            const casilla = document.createElement("div");
            casilla.className = "casilla " + ((f + c) % 2 === 0 ? "blanca" : "negra");
            casilla.dataset.fila = f;
            casilla.dataset.col = c;

            if ((f + c) % 2 !== 0) {
                if (f < 3) agregarPieza(casilla, "negra");
                if (f > 4) agregarPieza(casilla, "roja");
            }

            casilla.addEventListener("click", () => clickCasilla(casilla));
            tablero.appendChild(casilla);
        }
    }
}

function agregarPieza(casilla, color) {
    const p = document.createElement("div");
    p.className = "pieza " + (color === "roja" ? "roja" : "negra-pieza");
    p.dataset.color = color;
    p.dataset.dama = "false";
    casilla.appendChild(p);
}

function clickCasilla(casilla) {
    const pieza = casilla.querySelector(".pieza");

    if (pieza && pieza.dataset.color === turno) {
        if (seleccionada) seleccionada.classList.remove("seleccionada");
        seleccionada = pieza;
        pieza.classList.add("seleccionada");
        return;
    }

    if (seleccionada && !pieza && casilla.classList.contains("negra")) {
        intentarMover(casilla);
    }
}

function intentarMover(destino) {
    const origen = seleccionada.parentElement;
    const fO = +origen.dataset.fila;
    const cO = +origen.dataset.col;
    const fD = +destino.dataset.fila;
    const cD = +destino.dataset.col;

    const dama = seleccionada.dataset.dama === "true";
    const dirs = dama
        ? [[1,1],[1,-1],[-1,1],[-1,-1]]
        : [[turno === "roja" ? -1 : 1, 1], [turno === "roja" ? -1 : 1, -1]];

    for (let [df, dc] of dirs) {
        if (!debeSeguirComiendo && fD === fO + df && cD === cO + dc) {
            mover(destino);
            cambiarTurno();
            return;
        }

        if (fD === fO + df * 2 && cD === cO + dc * 2) {
            const medio = document.querySelector(
                `.casilla[data-fila="${fO+df}"][data-col="${cO+dc}"]`
            );
            const piezaMedia = medio?.querySelector(".pieza");

            if (piezaMedia && piezaMedia.dataset.color !== turno) {
                piezaMedia.remove();
                mover(destino);

                if (puedeSeguirComiendo(destino)) {
                    debeSeguirComiendo = true;
                    seleccionada.classList.add("seleccionada");
                } else {
                    debeSeguirComiendo = false;
                    cambiarTurno();
                }
                return;
            }
        }
    }
}

function mover(destino) {
    destino.appendChild(seleccionada);
    seleccionada.classList.remove("seleccionada");
    coronar(seleccionada, destino);
}

function coronar(pieza, casilla) {
    const fila = +casilla.dataset.fila;
    if (
        (pieza.dataset.color === "roja" && fila === 0) ||
        (pieza.dataset.color === "negra" && fila === 7)
    ) {
        pieza.dataset.dama = "true";
        pieza.classList.add("dama");
    }
}

function puedeSeguirComiendo(casilla) {
    const pieza = casilla.querySelector(".pieza");
    const fO = +casilla.dataset.fila;
    const cO = +casilla.dataset.col;
    const dama = pieza.dataset.dama === "true";

    const dirs = dama
        ? [[1,1],[1,-1],[-1,1],[-1,-1]]
        : [[turno === "roja" ? -1 : 1, 1], [turno === "roja" ? -1 : 1, -1]];

    for (let [df, dc] of dirs) {
        const medio = document.querySelector(
            `.casilla[data-fila="${fO+df}"][data-col="${cO+dc}"]`
        );
        const destino = document.querySelector(
            `.casilla[data-fila="${fO+df*2}"][data-col="${cO+dc*2}"]`
        );

        if (
            medio && destino &&
            medio.querySelector(".pieza") &&
            medio.querySelector(".pieza").dataset.color !== turno &&
            !destino.querySelector(".pieza")
        ) return true;
    }
    return false;
}

function cambiarTurno() {
    seleccionada = null;
    turno = turno === "roja" ? "negra" : "roja";
    turnoTexto.textContent = "Turno: " + (turno === "roja" ? "Rojas" : "Negras");
}

crearTablero();
</script>

</body>
</html>
